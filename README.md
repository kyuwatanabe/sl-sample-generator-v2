# 米国ビザ申請用 職務内容サンプル検索＋生成システム (Web版)

StreamlitからFlaskベースのWebアプリケーションに作り直したバージョンです。

## 機能

- **検索機能**: 15,358件のサンプルデータから条件に合致する職務内容を検索
- **AI生成機能**: 該当サンプルがない場合、OpenAI GPT-4で職務内容を生成
- **コピー機能**: 結果を個別または一括でクリップボードにコピー
- **レスポンシブデザイン**: PCでもスマートフォンでも快適に利用可能

## セットアップ

### 1. 依存関係のインストール

```bash
cd web_app
pip install -r requirements.txt
```

### 2. 環境変数の設定

`.env.example`を`.env`にコピーして、OpenAI APIキーを設定してください。

```bash
cp .env.example .env
```

`.env`ファイルを編集:
```
OPENAI_API_KEY=sk-proj-...
```

### 3. サーバー起動

```bash
python app.py
```

ブラウザで http://localhost:5000 にアクセスしてください。

## 技術スタック

- **バックエンド**: Flask 3.0
- **フロントエンド**: HTML5, CSS3, JavaScript, Bootstrap 5
- **AI**: OpenAI GPT-4 API
- **データ**: pandas, openpyxl

## ファイル構成

```
web_app/
├── app.py                 # Flaskアプリケーション本体
├── requirements.txt       # Python依存関係
├── .env.example          # 環境変数テンプレート
├── templates/
│   └── index.html        # メイン画面
├── static/
│   ├── css/
│   │   └── style.css     # スタイルシート
│   └── js/
│       └── main.js       # JavaScript
└── ../米国での業務内容.xlsx  # データファイル
```

## 使用方法

1. ポジション、業界、部門のいずれか（または複数）を入力
2. 「検索／生成する」ボタンをクリック
3. 結果が表示されます
   - データベースに該当がある場合: 緑色バッジで「データベースから検索」
   - 該当がない場合: 青色バッジで「AIで生成」
4. 各結果の「コピー」ボタンまたは「すべてコピー」ボタンで結果をコピー

## 同義語変換

以下の入力は自動的に正規化されます:

- 部長/マネージャー/CFO/社長 → 管理職
- 製薬 → 医薬品
- おもちゃ → 玩具
- 戦略/経営管理 → 経営企画

## トラブルシューティング

### エラー: "OpenAI APIキーが無効です"
- `.env`ファイルにAPIキーが正しく設定されているか確認してください

### エラー: "Excelファイルが見つかりません"
- `米国での業務内容.xlsx`が`web_app/`の親ディレクトリにあることを確認してください

### ポート5000が使用中
- `app.py`の最終行のポート番号を変更してください: `app.run(debug=True, port=5001)`
